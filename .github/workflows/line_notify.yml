name: Line Notify Stock Price

on:
  schedule:
    # 台北時間每天上午 9 點到下午 6 點，每小時運行一次（UTC+8 對應的 UTC 為凌晨 1 點到上午 10 點）
    - cron: '0 1-10 * * *'  # 每天 01:00-10:00 UTC，對應台北 09:00-18:00
  workflow_dispatch:  # 允許手動觸發

jobs:
  notify:
    runs-on: ubuntu-latest  # 使用 Ubuntu 環境執行
    steps:
      - name: Checkout Code  # 檢出儲存庫代碼
        uses: actions/checkout@v2

      - name: Setup Python  # 安裝 Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'

      - name: Install Dependencies  # 安裝所需的 Python 套件
        run: |
          pip install -r requirements.txt

      - name: Load environment variables  # 加載 .env 檔案
        run: echo "LINE_ACCESS_TOKEN=${{ secrets.LINE_ACCESS_TOKEN }}" >> $GITHUB_ENV
        env:
          LINE_ACCESS_TOKEN: ${{ secrets.LINE_ACCESS_TOKEN }}

      - name: Run the script  # 執行 Python 腳本
        run: |
          python app.py
